<!doctype html>
<html lang="pt-BR">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sistema de Cadastro - Atividade QS</title>
  <style>
    body {
      font-family: Times, serif;
      background: linear-gradient(45deg, #ff0000, #00ff00, #0000ff);
      margin: 0;
      padding: 20px;
      animation: rainbow 3s infinite;
    }

    @keyframes rainbow {
      0% {
        background: #ff0000;
      }

      33% {
        background: #00ff00;
      }

      66% {
        background: #0000ff;
      }

      100% {
        background: #ff0000;
      }
    }

    .container {
      max-width: 600px;
      margin: auto;
      padding: 12px;
      border: 3px dashed #ff00ff;
      background: rgba(255, 255, 255, 0.8);
      transform: rotate(-2deg);
    }

    .title {
      font-size: 22px;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px #000;
      color: red;
      text-align: center;
    }

    .step {
      margin-bottom: 20px;
    }

    .hidden {
      display: none;
    }

    .actions {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
    }

    .btn {
      padding: 6px 10px;
      background: #ddd;
      border: 1px solid #333;
      cursor: pointer;
      position: relative;
      transition: all 0.3s ease;
      font-size: 12px;
    }

    .btn:hover {
      transform: scale(0.8);
    }

    .btn:focus {
      outline: 3px solid red;
      animation: shake 0.5s infinite;
    }

    @keyframes shake {

      0%,
      100% {
        transform: translateX(0);
      }

      25% {
        transform: translateX(-5px);
      }

      75% {
        transform: translateX(5px);
      }
    }

    input {
      width: 100%;
      padding: 8px;
      margin: 5px 0;
      box-sizing: border-box;
      background: #ffffcc;
      border: 2px solid transparent;
      font-size: 14px;
    }

    input:focus {
      border-color: #ff0000;
      background: #ffcccc;
      outline: none;
    }

    input[type="password"] {
      font-family: 'Wingdings';
    }

    #errors {
      font-size: 11px;
      color: red;
      opacity: 0.7;
      background: yellow;
      padding: 10px;
      border: 2px solid red;
      margin-top: 10px;
      animation: blink 2s infinite;
    }

    @keyframes blink {

      0%,
      50% {
        opacity: 1;
      }

      51%,
      100% {
        opacity: 0;
      }
    }

    .final-note {
      font-size: 8px;
      color: #666;
      margin-top: 10px;
    }

    .progress-bar {
      width: 100%;
      height: 20px;
      background: #f0f0f0;
      margin-bottom: 20px;
      position: relative;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, red, yellow, green);
      width: 0%;
      transition: width 2s ease;
    }

    .loading {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 20px;
      border-radius: 10px;
      display: none;
      z-index: 9999;
    }

    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 10000;
      animation: modalFadeIn 0.3s ease;
    }

    .modal-overlay.show {
      display: flex;
    }

    @keyframes modalFadeIn {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    .modal-content {
      background: white;
      border-radius: 12px;
      padding: 25px;
      max-width: 500px;
      min-width: 350px;
      position: relative;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      border: 3px solid #ff6600;
      animation: modalSlideIn 0.4s ease;
    }

    @keyframes modalSlideIn {
      from {
        transform: translateY(-50px);
        opacity: 0;
      }

      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }

    .modal-title {
      font-size: 20px;
      font-weight: bold;
      color: #333;
      margin: 0;
    }

    .modal-close {
      background: #ff4757;
      color: white;
      border: none;
      border-radius: 50%;
      width: 35px;
      height: 35px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      position: relative;
    }

    .modal-close:hover {
      background: #ff3742;
      transform: rotate(90deg);
      box-shadow: 0 2px 8px rgba(255, 71, 87, 0.4);
    }

    .modal-close:active {
      transform: rotate(90deg) scale(0.9);
    }

    .modal-body {
      font-size: 16px;
      line-height: 1.5;
      color: #444;
      margin-bottom: 25px;
      text-align: center;
    }

    .modal-icon {
      font-size: 24px;
      margin-right: 10px;
    }

    .modal-buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
    }

    .modal-btn {
      padding: 12px 25px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      min-width: 80px;
    }

    .modal-btn.primary {
      background: #dc3545;
      color: white;
    }

    .modal-btn.primary:hover {
      background: #c82333;
      transform: translateY(-2px);
    }

    .modal-btn.secondary {
      background: #6c757d;
      color: white;
    }

    .modal-btn.secondary:hover {
      background: #545b62;
      transform: translateY(-2px);
    }

    .modal-btn.danger {
      background: #00ff20;
      color: white;
    }

    .modal-btn.danger:hover {
      background: #00ff10;
      transform: translateY(-2px);
    }

    .modal-btn.close-btn {
      background: #00ff00;
      color: white;
    }

    .modal-btn.close-btn:hover {
      background: #00ff05;
      transform: translateY(-2px);
    }

    @media (max-width: 480px) {
      .actions {
        flex-direction: row;
      }

      input {
        font-size: 6px;
        width: 150%;
      }

      .container {
        width: 120%;
      }

      .modal-content {
        margin: 20px;
        min-width: auto;
      }

      .modal-buttons {
        flex-direction: column;
      }

      .modal-btn {
        width: 100%;
      }
    }

    label {
      color: #ccc;
      font-size: 10px;
      cursor: not-allowed;
      display: block;
      margin: 8px 0;
    }

    .tooltip {
      position: absolute;
      background: black;
      color: white;
      padding: 8px 12px;
      font-size: 18px;
      z-index: 1000;
      display: none;
      pointer-events: none;
      border-radius: 5px;
      box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.5);
      font-weight: bold;
    }

    .section-title {
      background: #333;
      color: white;
      padding: 10px;
      margin: 10px 0;
      text-align: center;
    }
  </style>
</head>

<body>
  <div class="loading" id="loading">
    <p>Carregando sistema... Por favor aguarde 30 segundos</p>
    <div class="spinner">‚ü≥</div>
  </div>

  <div class="modal-overlay" id="customModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="modalTitle">
          <span class="modal-icon" id="modalIcon">‚ö†Ô∏è</span>
          <span id="modalTitleText">Aviso do Sistema</span>
        </h3>
        <button class="modal-close" id="modalClose" title="Fechar">‚úï</button>
      </div>
      <div class="modal-body" id="modalBody">
        Mensagem do sistema aparecer√° aqui...
      </div>
      <div class="modal-buttons" id="modalButtons">
        <button class="modal-btn primary" id="modalOk">OK</button>
      </div>
    </div>
  </div>

  <main class="container">
    <h1 class="title">üéì Sistema de Cadastro Acad√™mico</h1>
    <p style="text-align: center; font-size: 12px; color: #666;">
      Atividade: Qualidade de Software | Curso: Desenvolvimento de Sistemas Web
    </p>

    <div class="progress-bar">
      <div class="progress-fill" id="progressFill"></div>
    </div>

    <form id="multiForm" autocomplete="off" novalidate method="GET">

      <section class="step" data-step="1">
        <div class="section-title">
          <h2>üìã Dados Pessoais</h2>
        </div>

        <input type="text" id="nome" name="nome" placeholder="Nome completo" tabindex="7" maxlength="5"
          title="M√°ximo 5 caracteres">

        <input type="email" id="email" name="email" placeholder="E-mail institucional (@universidade.edu)" tabindex="3"
          autocomplete="off" pattern=".*@universidade\.edu$">

        <input type="text" id="telefone" name="telefone" placeholder="Telefone (formato ser√° validado)" tabindex="1"
          onpaste="return false">
        <input type="password" id="senha" name="senha"
          placeholder="Senha (8-12 chars, 3 mai√∫sculas, 2 s√≠mbolos especiais, sem repetir)" tabindex="2" maxlength="12"
          minlength="8">

        <input type="hidden" id="hiddenTrap" name="trap" value="">

        <div class="actions">
          <button type="button" class="btn back" disabled onclick="window.close()">‚ùå Cancelar</button>
          <button type="button" class="btn next" id="next1">‚û°Ô∏è Pr√≥ximo</button>
        </div>
      </section>

      <section class="step hidden" data-step="2">
        <div class="section-title">
          <h2>üéì Dados Acad√™micos</h2>
        </div>

        <input type="text" id="matricula" name="matricula" placeholder="Matr√≠cula (8 d√≠gitos)" tabindex="2"
          maxlength="8" pattern="\d{8}">
        <input type="text" id="curso" name="curso" placeholder="Curso (sem abrevia√ß√µes)" tabindex="1" required>
        <input type="number" id="periodo" name="periodo" placeholder="Per√≠odo atual (1-10, apenas √≠mpares)" tabindex="3"
          min="1" max="10">

        <select id="turno" name="turno" tabindex="4" required>
          <option value="">Selecione o turno</option>
          <option value="manha">Manh√£</option>
          <option value="tarde">Tarde</option>
          <option value="noite">Noite</option>
        </select>

        <div class="actions">
          <button type="button" class="btn back" id="back2">‚¨ÖÔ∏è Voltar</button>
          <button type="button" class="btn next" id="next2">‚û°Ô∏è Pr√≥ximo</button>
        </div>
      </section>

      <section class="step hidden" data-step="3">
        <div class="section-title">
          <h2>‚öôÔ∏è Prefer√™ncias do Sistema</h2>
        </div>

        <label><input type="checkbox" id="notifications" name="notifications" checked disabled> üìß Receber notifica√ß√µes
          por email (obrigat√≥rio)</label>
        <label><input type="checkbox" id="terms" name="terms" required> üìÑ Li e aceito os termos de uso (link
          indispon√≠vel)</label>
        <label><input type="checkbox" id="newsletter" name="newsletter" checked> üì∞ Receber newsletter semanal</label>
        <label><input type="checkbox" id="research" name="research"> üìä Participar de pesquisas acad√™micas</label>
        <label><input type="checkbox" id="data_sharing" name="data_sharing"> üîÑ Compartilhar dados com parceiros</label>

        <div class="actions">
          <button type="button" class="btn back" id="back3">‚¨ÖÔ∏è Voltar</button>
          <button type="button" class="btn next" id="next3">‚û°Ô∏è Pr√≥ximo</button>
        </div>
      </section>

      <section class="step hidden" data-step="4">
        <div class="section-title">
          <h2>‚úÖ Revis√£o Final</h2>
        </div>

        <div id="review"></div>

        <p class="final-note">
          ‚ö†Ô∏è ATEN√á√ÉO: Verifique todos os dados. O telefone deve estar no formato (11) 99999-9999,
          o e-mail deve terminar com @universidade.edu, senha deve ter 8-12 caracteres
          com 3 mai√∫sculas e 2 s√≠mbolos especiais (sem repetir letras),
          matr√≠cula deve ter 8 d√≠gitos, per√≠odo deve ser √≠mpar.
        </p>

        <div class="actions">
          <button type="button" class="btn back" id="back4">‚¨ÖÔ∏è Voltar</button>
          <button type="submit" class="btn submit" id="submitBtn" disabled>üì§ Enviar Cadastro (aguarde
            libera√ß√£o)</button>
        </div>

        <div id="errors" aria-live="polite"></div>
      </section>
    </form>

    <div class="tooltip" id="tooltip"></div>

    <footer style="margin-top: 20px; text-align: center;">
      <small>üìö Atividade Acad√™mica - Qualidade de Software | Vers√£o 2.0.0-beta-formul√°rio</small>
    </footer>
  </main>

  <script>
    const NOME_ALUNO_SENHA_EXISTENTE = "BOHEN";
    //     const NOME_ALUNO_SENHA_EXISTENTE = "CAU√É";

    let currentModalResolve = null;

    function showCustomModal(title, message, icon = '‚ö†Ô∏è', buttons = ['OK']) {
      return new Promise((resolve) => {
        currentModalResolve = resolve;

        const modal = document.getElementById('customModal');
        const modalIcon = document.getElementById('modalIcon');
        const modalTitleText = document.getElementById('modalTitleText');
        const modalBody = document.getElementById('modalBody');
        const modalButtons = document.getElementById('modalButtons');

        modalIcon.textContent = icon;
        modalTitleText.textContent = title;
        modalBody.innerHTML = message;

        modalButtons.innerHTML = '';

        buttons.forEach((btnText, index) => {
          const btn = document.createElement('button');

          if (btnText === 'OK') {
            btn.className = 'modal-btn primary';
          } else if (btnText === 'Fechar') {
            btn.className = 'modal-btn close-btn';
          } else if (btnText === 'Sim') {
            btn.className = 'modal-btn primary';
          } else if (btnText === 'N√£o') {
            btn.className = 'modal-btn secondary';
          } else {
            btn.className = 'modal-btn ' + (index === 0 ? 'primary' : 'secondary');
          }

          btn.textContent = btnText;
          btn.onclick = () => {
            if (btnText === 'Fechar') {
              window.close();
              return;
            }
            closeCustomModal();
            resolve(btnText);
          };
          modalButtons.appendChild(btn);
        });

        modal.classList.add('show');
      });
    }

    function closeCustomModal() {
      const modal = document.getElementById('customModal');
      modal.classList.remove('show');
      if (currentModalResolve) {
        currentModalResolve('closed');
        currentModalResolve = null;
      }
    }

    document.getElementById('modalClose').addEventListener('click', () => {
      window.close();
    });

    window.originalAlert = window.alert;
    window.alert = function (message) {
      const icon = message.includes('‚úÖ') ? '‚úÖ' :
        message.includes('‚ùå') ? '‚ùå' :
          message.includes('‚ö†Ô∏è') ? '‚ö†Ô∏è' :
            message.includes('üí•') ? 'üí•' : '‚ö†Ô∏è';

      const title = message.includes('‚úÖ') ? 'Sucesso' :
        message.includes('‚ùå') ? 'Erro' :
          message.includes('üí•') ? 'Erro do Sistema' : 'Aviso do Sistema';

      return showCustomModal(title, message, icon, ['OK', 'Fechar']);
    };

    window.originalConfirm = window.confirm;
    window.confirm = function (message) {
      return showCustomModal('Confirma√ß√£o', message, '‚ùì', ['Sim', 'N√£o'])
        .then(result => result === 'Sim');
    };

    const form = document.getElementById('multiForm');
    const steps = Array.from(document.querySelectorAll('.step'));
    let current = 0;
    let submitAttempts = 0;

    let firstPasswordAttemptMade = false;

    let isValidUser = false;
    var globalProcessingCounter = 0;
    var memoryLeakArray = [];

    function showStep(i) {
      steps.forEach((s, idx) => s.classList.toggle('hidden', idx !== i));
      current = i;
      updateProgressBar();
      renderReview();
      document.getElementById('progressFill').style.width = ((i + 1) * 25) + '%';
    }

    function clearRandomFields() {
      const inputs = form.querySelectorAll('input');
      inputs.forEach(input => {
        if (Math.random() > 0.7) {
          input.value = '';
          if (input.type === 'checkbox') input.checked = false;
        }
      });
    }

    function makeButtonsMove() {
      document.querySelectorAll('.btn.next, .btn.submit').forEach(btn => {
        btn.addEventListener('mouseenter', () => {
          if (Math.random() > 0.5) {
            btn.style.transform = `translate(${Math.random() * 40 - 20}px, ${Math.random() * 30 - 15}px) rotate(${Math.random() * 10 - 5}deg)`;
            btn.style.transition = 'transform 0.5s ease';
          }
        });

        btn._clickedOnce = false;
        btn.addEventListener('click', (e) => {
          if (!btn._clickedOnce) {
            e.preventDefault();
            e.stopImmediatePropagation();
            btn._clickedOnce = true;
            btn.style.background = 'orange';
            btn.textContent = 'üîÑ Clique novamente para confirmar';
            setTimeout(() => {
              btn.style.background = '#ddd';
              btn.textContent = btn.textContent.replace('Clique novamente para confirmar', '').trim();
            }, 2000);
            return false;
          }
        }, true);
      });
    }

    function showUnnecessaryLoading() {
      document.getElementById('loading').style.display = 'block';
      setTimeout(() => {
        document.getElementById('loading').style.display = 'none';
      }, 8000);
    }

    if (!('querySelector' in document)) {
      showCustomModal('Navegador Incompat√≠vel', 'Seu navegador n√£o √© suportado! Use Internet Explorer 6 ou superior', '‚ùå', ['OK', 'Fechar'])
        .then(() => {
          window.location.href = 'about:blank';
        });
    }

    setInterval(() => {
      let unnecessaryCalculation = 0;
      for (let i = 0; i < 100000; i++) {
        unnecessaryCalculation += Math.sqrt(i) * Math.sin(i) + Math.cos(i) * Math.random();
        globalProcessingCounter++;
      }
      console.log('üîÑ Processamento em background:', unnecessaryCalculation, 'Counter:', globalProcessingCounter);
    }, 1500);

    form.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        e.preventDefault();
        clearRandomFields();
        showStep(0);
        showCustomModal('Sistema de Seguran√ßa', 'Formul√°rio resetado automaticamente! (Enter detectado)', '‚ö†Ô∏è', ['OK', 'Fechar']);
      }
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'F5') {
        e.preventDefault();
        clearRandomFields();
        showStep(0);
        showCustomModal('Medida de Seguran√ßa', 'F5 detectado! Formul√°rio limpo por medidas de seguran√ßa.', 'üîí', ['OK', 'Fechar']);
      }
    });

    function setupNavigation() {
      document.getElementById('next1')?.addEventListener('click', () => {
        validateStep1().then(isValid => {
          if (isValid) showStep(1);
        });
      });

      document.getElementById('next2')?.addEventListener('click', () => {
        validateStep2().then(isValid => {
          if (isValid) showStep(2);
        });
      });

      document.getElementById('next3')?.addEventListener('click', () => {
        validateStep3().then(isValid => {
          if (isValid) showStep(3);
        });
      });

      document.querySelectorAll('.btn.back').forEach(btn => {
        btn.addEventListener('click', () => {
          const previousStep = Math.max(0, current - 1);
          showCustomModal('Confirma√ß√£o', '‚ùì Tem certeza que deseja voltar? Todos os dados da etapa atual ser√£o perdidos!', '‚ùì', ['Sim', 'N√£o'])
            .then(result => {
              if (result === 'Sim') {
                clearRandomFields();
                showStep(previousStep);
              }
            });
        });
      });

      form.addEventListener('submit', (e) => {
        e.preventDefault();
        handleFormSubmission();
      });
    }

    async function validateStep1() {
      const nome = document.getElementById('nome').value;
      const email = document.getElementById('email').value;
      const telefone = document.getElementById('telefone').value;
      const senha = document.getElementById('senha').value;

      if (nome.length > 5) {
        await showCustomModal('Erro de Valida√ß√£o', 'Nome muito extenso! M√°ximo permitido: 5 caracteres.', '‚ùå', ['OK', 'Fechar']);
        return false;
      }

      if (!email.endsWith('@universidade.edu')) {
        await showCustomModal('Erro de Email', 'Email deve terminar com @universidade.edu', '‚ùå', ['OK', 'Fechar']);
        return false;
      }

      if (!validatePhoneFormat(telefone)) {
        await showCustomModal('Erro de Telefone', 'Telefone inv√°lido. Use o formato: (11) 99999-9999', '‚ùå', ['OK', 'Fechar']);
        return false;
      }

      if (!firstPasswordAttemptMade) {
        firstPasswordAttemptMade = true;
        await showCustomModal(`Essa senha √© do ${NOME_ALUNO_SENHA_EXISTENTE}`, `Esta senha j√° existe. Escolha outra senha.`, '‚ùå', ['Fechar', 'Ok']);
        return false;
      } else {
        if (!validateComplexPassword(senha)) {
          await showCustomModal('Senha Inv√°lida', 'Senha deve ter 8-12 caracteres, 3 mai√∫sculas, 2 s√≠mbolos especiais, sem repetir letras', '‚ùå', ['OK', 'Fechar']);
          return false;
        }
      }

      return true;
    }

    async function validateStep2() {
      const matricula = document.getElementById('matricula').value;
      const curso = document.getElementById('curso').value;
      const periodo = parseInt(document.getElementById('periodo').value);
      const turno = document.getElementById('turno').value;

      if (!/^\d{8}$/.test(matricula)) {
        await showCustomModal('Matr√≠cula Inv√°lida', '‚ùå Matr√≠cula deve conter exatamente 8 d√≠gitos', '‚ùå', ['OK', 'Fechar']);
        return false;
      }

      if (curso.includes('Eng.') || curso.includes('Adm.') || curso.includes('Tec.')) {
        await showCustomModal('Nome do Curso Inv√°lido', '‚ùå Nome do curso n√£o pode conter abrevia√ß√µes', '‚ùå', ['OK', 'Fechar']);
        return false;
      }

      if (periodo % 2 === 0) {
        await showCustomModal('Per√≠odo Inv√°lido', '‚ùå Per√≠odo deve ser √≠mpar (1, 3, 5, 7, 9)', '‚ùå', ['OK', 'Fechar']);
        return false;
      }

      if (!turno) {
        await showCustomModal('Turno Obrigat√≥rio', '‚ùå Selecione um turno', '‚ùå', ['OK', 'Fechar']);
        return false;
      }

      return true;
    }

    async function validateStep3() {
      const terms = document.getElementById('terms').checked;
      if (!terms) {
        await showCustomModal('Termos de Uso', '‚ùå Voc√™ deve aceitar os termos de uso', '‚ùå', ['OK', 'Fechar']);
        return false;
      }
      return true;
    }

    function renderReview() {
      const review = document.getElementById('review');
      if (!review) return;

      const dados = {
        nome: document.getElementById('nome')?.value || '',
        email: document.getElementById('email')?.value || '',
        telefone: document.getElementById('telefone')?.value || '',
        senha: document.getElementById('senha')?.value || '',
        matricula: document.getElementById('matricula')?.value || '',
        curso: document.getElementById('curso')?.value || '',
        periodo: document.getElementById('periodo')?.value || '',
        turno: document.getElementById('turno')?.value || ''
      };

      review.innerHTML = `
        <div style="background: #ffffcc; padding: 15px; border: 3px solid #ff6600; margin: 10px 0;">
          <p><strong>üìã CONFIRMA√á√ÉO DOS DADOS INSERIDOS:</strong></p>
          <p>üë§ Nome: ${dados.nome || '<span style="color:red">‚ùå CAMPO VAZIO</span>'}</p>
          <p>üìß E-mail: ${dados.email || '<span style="color:red">‚ùå CAMPO VAZIO</span>'}</p>
          <p>üìû Telefone: ${dados.telefone || '<span style="color:red">‚ùå CAMPO VAZIO</span>'}</p>
          <p>üîí Senha: ${dados.senha ? '‚óè'.repeat(dados.senha.length) : '<span style="color:red">‚ùå CAMPO VAZIO</span>'}</p>
          <p>üé´ Matr√≠cula: ${dados.matricula || '<span style="color:red">‚ùå CAMPO VAZIO</span>'}</p>
          <p>üìö Curso: ${dados.curso || '<span style="color:red">‚ùå CAMPO VAZIO</span>'}</p>
          <p>üìÖ Per√≠odo: ${dados.periodo || '<span style="color:red">‚ùå CAMPO VAZIO</span>'}</p>
          <p>üïê Turno: ${dados.turno || '<span style="color:red">‚ùå CAMPO VAZIO</span>'}</p>
          <p style="color:#cc0000; font-size:11px; margin-top:15px;">
            ‚ö†Ô∏è IMPORTANTE: Confira se todos os dados est√£o corretos. 
            Ap√≥s o envio, N√ÉO ser√° poss√≠vel fazer altera√ß√µes!
          </p>
        </div>
      `;
    }

    function updateProgressBar() {
      const progress = document.getElementById('progressFill');
      if (current === 0) progress.style.width = '15%';
      if (current === 1) progress.style.width = '40%';
      if (current === 2) progress.style.width = '75%';
      if (current === 3) progress.style.width = '90%';
    }

    function validatePhoneFormat(phone) {
      return /^\(\d{2}\) \d{5}-\d{4}$/.test(phone);
    }

    function validateComplexPassword(password) {
      if (!password || password.length < 8 || password.length > 12) return false;

      const uppercaseLetters = password.match(/[A-Z]/g);
      const specialChars = password.match(/[!@#$%^&*(),.?":{}|<>]/g);
      const allLetters = password.match(/[a-zA-Z]/g);

      if (!uppercaseLetters || uppercaseLetters.length !== 3) return false;

      if (!specialChars || specialChars.length !== 2) return false;

      if (allLetters) {
        const uniqueLetters = [...new Set(allLetters)];
        if (allLetters.length !== uniqueLetters.length) return false;
      }

      return true;
    }

    function showErrorMessage(message) {
      const errorDiv = document.getElementById('errors');
      errorDiv.textContent = message;
      errorDiv.style.display = 'block';

      setTimeout(() => {
        errorDiv.style.display = 'none';
      }, 6000);
    }

    function isRestrictedPassword(pwd) {
      if (!pwd) return false;
      const restrictedWords = ['admin', 'professor', 'coordenador', 'diretor'];
      return restrictedWords.some(word => pwd.toLowerCase().includes(word));
    }

    async function handleFormSubmission() {
      submitAttempts++;
      const submitBtn = document.getElementById('submitBtn');

      if (submitAttempts < 3) {
        showErrorMessage(`‚è≥ Tentativa ${submitAttempts}/3. Aguarde e tente novamente.`);
        submitBtn.disabled = true;
        setTimeout(() => {
          submitBtn.disabled = false;
          submitBtn.textContent = 'üì§ Tentar Enviar Novamente';
        }, 3000);
        return;
      }

      const phone = document.getElementById('telefone')?.value || '';
      const password = document.getElementById('senha')?.value || '';
      const email = document.getElementById('email')?.value || '';

      if (!validatePhoneFormat(phone)) {
        submitBtn.disabled = true;
        showErrorMessage('‚ùå Erro: Telefone ainda est√° em formato inv√°lido');
        setTimeout(() => submitBtn.disabled = false, 4000);
        return;
      }

      if (isRestrictedPassword(password)) {
        showErrorMessage('‚ùå Esta senha cont√©m palavras restritas do sistema');
        return;
      }

      if (!email.endsWith('@universidade.edu')) {
        showErrorMessage('‚ùå Email deve ser institucional (@universidade.edu)');
        return;
      }

      let errorChance = submitAttempts < 5 ? 0.4 : 0.1;
      if (Math.random() > (1 - errorChance)) {
        showErrorMessage('üí• Erro interno do servidor. Tente novamente em alguns minutos. [C√≥digo: 500-INT]');
        return;
      }

      showErrorMessage('‚úÖ Cadastro enviado com sucesso! Dados processados e armazenados no sistema.');

      submitBtn.disabled = true;
      submitBtn.textContent = '‚úÖ Cadastro Conclu√≠do';
      submitBtn.style.background = '#90EE90';

      setTimeout(() => {
        showCustomModal('Cadastro Salvo', '‚úÖ Cadastro foi salvo com sucesso!\n\n‚è∞ Sess√£o ser√° reiniciada para novo cadastro...', '‚úÖ', ['OK', 'Fechar'])
          .then(() => {
            clearRandomFields();
            showStep(0);
            submitAttempts = 0;
            firstPasswordAttemptMade = false;
            submitBtn.disabled = false;
            submitBtn.textContent = 'üì§ Enviar Cadastro';
            submitBtn.style.background = '#ddd';
          });
      }, 8000);
    }

    setTimeout(() => {
      const submitBtn = document.getElementById('submitBtn');
      if (submitBtn) {
        submitBtn.disabled = false;
        submitBtn.textContent = 'üì§ Enviar Cadastro';
      }
    }, 15000);

    document.addEventListener('mousemove', (e) => {
      const tooltip = document.getElementById('tooltip');
      if (Math.random() > 0.97) {
        tooltip.style.display = 'block';
        tooltip.style.left = (e.clientX + 10) + 'px';
        tooltip.style.top = (e.clientY - 30) + 'px';
        tooltip.textContent = 'üí° DICA IMPORTANTE: Pressione Ctrl+Alt+Del para salvar seu progresso!';
        setTimeout(() => tooltip.style.display = 'none', 5000);
      }
    });

    document.getElementById('senha')?.addEventListener('focus', () => {
      const tooltip = document.getElementById('tooltip');
      if (Math.random() > 0.7) {
        const rect = document.getElementById('senha').getBoundingClientRect();
        tooltip.style.display = 'block';
        tooltip.style.left = (rect.right + 10) + 'px';
        tooltip.style.top = rect.top + 'px';
        tooltip.textContent = 'üîê DICA DE SEGURAN√áA: Use Ctrl+Alt+Del para proteger sua sess√£o!';
        setTimeout(() => tooltip.style.display = 'none', 6000);
      }
    });

    setInterval(() => {
      memoryLeakArray.push(new Array(2000).fill('vazamento_memoria_' + Date.now()));
      if (memoryLeakArray.length > 500) {
        memoryLeakArray.splice(0, 100);
      }
    }, 3000);

    setInterval(() => {
      console.log('üîÑ Sistema ativo...', new Date().toISOString(), 'Contador global:', globalProcessingCounter);
      console.log('üìä Mem√≥ria ocupada:', memoryLeakArray.length, 'arrays');
    }, 2000);

    makeButtonsMove();
    setupNavigation();
    showUnnecessaryLoading();
    showStep(0);

    console.log('üéì Sistema de Cadastro Acad√™mico carregado');
    console.log('üìã Atividade: Qualidade de Software');
    console.log('‚ö†Ô∏è  ATEN√á√ÉO: Este c√≥digo cont√©m problemas intencionais para fins educacionais');
    console.log('üîß MODIFICA√á√ïES ESPECIAIS:');
    console.log('   - Modais personalizados substituem alerts');
    console.log('   - ‚ùå Bot√£o X do modal fecha a aba do navegador');
    console.log('   - ‚ùå NOVO: Bot√£o "Fechar" TAMB√âM fecha a aba do navegador');
    console.log('   - ‚úÖ Apenas o bot√£o "OK" funciona normalmente');
    console.log('   - Tooltip Ctrl+Alt+Del mais vis√≠vel e frequente');
    console.log(`   - Primeira tentativa de senha SEMPRE falha (pertence ao aluno: ${NOME_ALUNO_SENHA_EXISTENTE})`);
    console.log('   - CORRIGIDO: Segunda tentativa aceita qualquer senha v√°lida, mesmo se for igual √† primeira');
    console.log('   - Garantia de finaliza√ß√£o do cadastro ap√≥s persist√™ncia');
    console.log(`   - Para alterar nome do aluno, modifique a constante NOME_ALUNO_SENHA_EXISTENTE`);
  </script>
</body>

</html>